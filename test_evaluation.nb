(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15033,        422]
NotebookOptionsPosition[     12191,        365]
NotebookOutlinePosition[     12589,        381]
CellTagsIndexPosition[     12546,        378]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"<<", " ", "Sigma.m"}]], "Input",
 CellChangeTimes->{{3.861942292327854*^9, 3.861942300472209*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"0c1c10d7-5575-4948-b416-9525f50c226f"],

Cell[BoxData["\<\"Oups, the package is already loaded! You cannot reload \
it.\"\>"], "Print",
 CellFrame->0.5,
 CellChangeTimes->{3.863172659058588*^9, 3.863173372800012*^9},
 FontColor->RGBColor[0, 0, 0],
 Background->RGBColor[0.796887, 0.789075, 0.871107],
 ButtonBoxOptions->{Active->True},
 CellLabel->
  "During evaluation of \
In[20]:=",ExpressionUUID->"50f5f3b9-b643-4478-973e-968910c631d4"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.863173372805875*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"4a65b1f8-4d0f-477c-a36d-cbc87d96210b"]
}, Open  ]],

Cell["needs: fun_Evaluation", "Text",
 CellChangeTimes->{{3.863232088485463*^9, 3.863232111636888*^9}, 
   3.863232152484537*^9},ExpressionUUID->"e628ad2b-175f-463d-91a8-\
89f246763628"],

Cell[CellGroupData[{

Cell["Evaluation function: creation and use", "Subsubsection",
 CellChangeTimes->{{3.863164490590867*^9, 3.8631644945587*^9}, {
  3.8632320652375526`*^9, 
  3.863232073781371*^9}},ExpressionUUID->"9ca89732-6292-4675-8bd7-\
2cfb4e5915aa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"toyTower", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x", ",", "1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", "q", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", "[", "1", "]"}], ",", 
      RowBox[{
       RowBox[{"7", "x"}], "+", 
       RowBox[{"y", "/", 
        RowBox[{"x", "^", "2"}]}]}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"p", "[", "2", "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", "2"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"x", "+", "2"}], ")"}]}], ",", "0"}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.863164497855592*^9, 3.863164572719081*^9}, {
  3.8631646160241327`*^9, 3.863164650102968*^9}, {3.863173483171218*^9, 
  3.863173484210318*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"3838ff4a-fea3-4355-ba46-bfeb4f04d1dc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", "q", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p", "[", "1", "]"}], ",", 
     RowBox[{
      RowBox[{"7", " ", "x"}], "+", 
      FractionBox["y", 
       SuperscriptBox["x", "2"]]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"p", "[", "2", "]"}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "2"}], "+", "x"}], 
      RowBox[{"2", "+", "x"}]], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8631734922390947`*^9, 3.8632319785074244`*^9, 
  3.863232160651688*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"b409b1dd-eba7-431b-b622-4231c5e303f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"toyBounds", "=", 
  RowBox[{"{", 
   RowBox[{"3", ",", "5"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.863164580887741*^9, 3.8631646116700897`*^9}, {
  3.8631646645178137`*^9, 3.863164665558119*^9}, {3.863164860325639*^9, 
  3.863164860916458*^9}, {3.863167052073483*^9, 3.8631670539207582`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"53b2d689-dd6b-400b-98a7-3807434c1a43"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "5"}], "}"}]], "Output",
 CellChangeTimes->{3.863164666534602*^9, 3.863164861740649*^9, 
  3.863167056494771*^9, 3.863172106947854*^9, 3.86317222398588*^9, 
  3.863172333842791*^9, 3.86317243310424*^9, 3.863172540308125*^9, 
  3.8631727590680637`*^9, 3.8632319807754107`*^9, 3.863232163781753*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"c6164823-1c7d-4614-9d08-c5191343ce10"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"toyElt", "=", 
  RowBox[{
   RowBox[{"p", "[", "1", "]"}], "x", "*", 
   RowBox[{
    RowBox[{"y", "^", "3"}], "/", 
    RowBox[{"p", "[", "2", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.863164900629219*^9, 3.8631649492195597`*^9}, {
  3.863165295544446*^9, 3.863165297008305*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"ea3000ff-c7b5-42dd-a198-ac88ceb644b9"],

Cell[BoxData[
 FractionBox[
  RowBox[{"x", " ", 
   SuperscriptBox["y", "3"], " ", 
   RowBox[{"p", "[", "1", "]"}]}], 
  RowBox[{"p", "[", "2", "]"}]]], "Output",
 CellChangeTimes->{3.8631649515783253`*^9, 3.863165298314286*^9, 
  3.863172110998109*^9, 3.863172228135878*^9, 3.863172339328367*^9, 
  3.86317243831944*^9, 3.863172545654632*^9, 3.863173529693694*^9, 
  3.8632319834653187`*^9, 3.863232166456892*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"149badc1-9334-4ab8-90c6-4a4c93de942e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"evMap", "=", 
  RowBox[{"buildEvMap", "[", 
   RowBox[{"toyTower", ",", "toyBounds"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.863165878159342*^9, 3.863165968082528*^9}, {
  3.863165999314039*^9, 3.863166703159622*^9}, {3.8631668486121063`*^9, 
  3.863166861011971*^9}, {3.863166894050584*^9, 3.863166933265333*^9}, {
  3.8631670297723913`*^9, 3.863167031392633*^9}, {3.863173543636228*^9, 
  3.8631735460249357`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"e13f5bff-f106-4db7-a13f-f4783193258d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x", "\[Rule]", 
    SubscriptBox["\[Iota]", "0"]}], ",", 
   RowBox[{"y", "\[Rule]", 
    SuperscriptBox["q", 
     SubscriptBox["\[Iota]", "0"]]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "1", "]"}], "\[Rule]", 
    RowBox[{
     UnderoverscriptBox[
      SuperscriptBox["\[Product]", "."], 
      RowBox[{
       SubscriptBox["\[Iota]", "1"], "=", "3"}], 
      SubscriptBox["\[Iota]", "0"]], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        SuperscriptBox["q", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["\[Iota]", "1"]}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["\[Iota]", "1"]}], ")"}], "2"]], "+", 
       RowBox[{"7", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["\[Iota]", "1"]}], ")"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"p", "[", "2", "]"}], "\[Rule]", 
    RowBox[{
     UnderoverscriptBox[
      SuperscriptBox["\[Product]", "."], 
      RowBox[{
       SubscriptBox["\[Iota]", "2"], "=", "5"}], 
      SubscriptBox["\[Iota]", "0"]], 
     RowBox[{"(", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "3"}], "+", 
        SubscriptBox["\[Iota]", "2"]}], 
       RowBox[{"1", "+", 
        SubscriptBox["\[Iota]", "2"]}]], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.86317266728695*^9, {3.863172749586494*^9, 3.863172763558402*^9}, 
   3.863172836574275*^9, 3.863172934061679*^9, {3.863173002468589*^9, 
   3.8631730279547443`*^9}, 3.8631733525838346`*^9, 3.8631734300655527`*^9, 
   3.863173500998032*^9, 3.863173547108724*^9, 3.8631739090214043`*^9, 
   3.8631739408562613`*^9, 3.863173991997758*^9, 3.8631741817461576`*^9, 
   3.8631742168545094`*^9, 3.8631743395657167`*^9, 3.8632319879361877`*^9, 
   3.8632321697766037`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"e6304628-22cb-458d-809c-7f7b48aacae9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["toyElt"], "Input",
 CellChangeTimes->{{3.863174097253137*^9, 3.863174098661086*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"dfbe1a3d-bace-4afc-905c-3b6d2ac160b5"],

Cell[BoxData[
 FractionBox[
  RowBox[{"x", " ", 
   SuperscriptBox["y", "3"], " ", 
   RowBox[{"p", "[", "1", "]"}]}], 
  RowBox[{"p", "[", "2", "]"}]]], "Output",
 CellChangeTimes->{3.863174099027067*^9, 3.863174231748156*^9, 
  3.8632321746802177`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"8f6fdf80-99a3-4b02-9724-278b07360df0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EvElt", "=", 
  RowBox[{"toyElt", "/.", " ", "evMap", " "}]}]], "Input",
 CellChangeTimes->{{3.863173537720991*^9, 3.863173571249736*^9}, {
   3.863173962854272*^9, 3.863173972149825*^9}, 3.8631740454301033`*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"b1fba865-8e36-4e58-a48b-28b11b3e9e23"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["q", 
   RowBox[{"3", " ", 
    SubscriptBox["\[Iota]", "0"]}]], " ", 
  SubscriptBox["\[Iota]", "0"], " ", 
  RowBox[{"(", 
   RowBox[{
    UnderoverscriptBox[
     SuperscriptBox["\[Product]", "."], 
     RowBox[{
      SubscriptBox["\[Iota]", "1"], "=", "3"}], 
     SubscriptBox["\[Iota]", "0"]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SuperscriptBox["q", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["\[Iota]", "1"]}]], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["\[Iota]", "1"]}], ")"}], "2"]], "+", 
      RowBox[{"7", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["\[Iota]", "1"]}], ")"}]}]}], ")"}]}], ")"}], " ", 
  RowBox[{
   UnderoverscriptBox[
    SuperscriptBox["\[Product]", "."], 
    RowBox[{
     SubscriptBox["\[Iota]", "2"], "=", "5"}], 
    SubscriptBox["\[Iota]", "0"]], 
   RowBox[{"(", 
    FractionBox[
     RowBox[{"1", "+", 
      SubscriptBox["\[Iota]", "2"]}], 
     RowBox[{
      RowBox[{"-", "3"}], "+", 
      SubscriptBox["\[Iota]", "2"]}]], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.863173553399077*^9, 3.863173572590063*^9}, {
   3.863173951578424*^9, 3.8631739940112467`*^9}, 3.8631740464660797`*^9, 
   3.863174113779746*^9, 3.863174233747918*^9, 3.8631743446760178`*^9, 
   3.863231992668498*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"17545e73-30ec-4696-aeb0-a5161afec6e9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EvElt", "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"IndexName", "[", "0", "]"}], "->", "5"}], ",", 
    RowBox[{"q", "->", "6"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.863174051668888*^9, 3.8631740532210217`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"8ad8f2de-ca8b-40e9-9f86-d15acc512edb"],

Cell[BoxData["795658785524121600"], "Output",
 CellChangeTimes->{3.863174054565175*^9, 3.863174236051941*^9, 
  3.86317434676377*^9, 3.863231995507626*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"723d85b3-b24c-4fa3-96f3-78471d027fd1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ev", "[", 
  RowBox[{"toyElt", ",", "8", ",", " ", "toyTower", ",", "toyBounds"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.863174467303954*^9, 3.863174504849742*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"a95ea81d-176c-4f91-8ebb-e735b9e3085c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}], ",", 
   SuperscriptBox["y", "3"], ",", 
   RowBox[{"p", "[", "1", "]"}], ",", 
   FractionBox["1", 
    RowBox[{"p", "[", "2", "]"}]]}], "}"}]], "Output",
 CellChangeTimes->{3.863174505213523*^9, 3.863232012769272*^9, 
  3.8632321782107353`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"431cad6e-4bd7-4fbf-baa4-ed6bd9f9f380"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.863172384226584*^9, 
  3.863172399809441*^9}},ExpressionUUID->"6d2e5427-f91e-4a89-8e94-\
5e467dec3379"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8631724836580467`*^9, 
  3.8631724997687798`*^9}},ExpressionUUID->"501a1311-2a27-43f7-8399-\
bf2a4ed058fc"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.863172264196261*^9, 3.863172264994369*^9}, 
   3.8631722955780582`*^9},ExpressionUUID->"9bc78e3c-edd0-40a6-aedf-\
abd2052bcd2f"]
}, Open  ]]
},
WindowSize->{468, 723},
WindowMargins->{{3.75, Automatic}, {Automatic, 21.75}},
FrontEndVersion->"13.0 for Linux x86 (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"40bc0635-d2ec-4fee-be8d-1e1bfbf4458e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 201, 3, 29, "Input",ExpressionUUID->"0c1c10d7-5575-4948-b416-9525f50c226f"],
Cell[784, 27, 399, 9, 61, "Print",ExpressionUUID->"50f5f3b9-b643-4478-973e-968910c631d4"],
Cell[1186, 38, 156, 2, 33, "Output",ExpressionUUID->"4a65b1f8-4d0f-477c-a36d-cbc87d96210b"]
}, Open  ]],
Cell[1357, 43, 186, 3, 35, "Text",ExpressionUUID->"e628ad2b-175f-463d-91a8-89f246763628"],
Cell[CellGroupData[{
Cell[1568, 50, 237, 4, 45, "Subsubsection",ExpressionUUID->"9ca89732-6292-4675-8bd7-2cfb4e5915aa"],
Cell[CellGroupData[{
Cell[1830, 58, 928, 27, 71, "Input",ExpressionUUID->"3838ff4a-fea3-4355-ba46-bfeb4f04d1dc"],
Cell[2761, 87, 771, 23, 77, "Output",ExpressionUUID->"b409b1dd-eba7-431b-b622-4231c5e303f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3569, 115, 399, 7, 29, "Input",ExpressionUUID->"53b2d689-dd6b-400b-98a7-3807434c1a43"],
Cell[3971, 124, 425, 7, 33, "Output",ExpressionUUID->"c6164823-1c7d-4614-9d08-c5191343ce10"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4433, 136, 386, 9, 29, "Input",ExpressionUUID->"ea3000ff-c7b5-42dd-a198-ac88ceb644b9"],
Cell[4822, 147, 494, 10, 53, "Output",ExpressionUUID->"149badc1-9334-4ab8-90c6-4a4c93de942e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5353, 162, 522, 9, 29, "Input",ExpressionUUID->"e13f5bff-f106-4db7-a13f-f4783193258d"],
Cell[5878, 173, 2001, 56, 140, "Output",ExpressionUUID->"e6304628-22cb-458d-809c-7f7b48aacae9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7916, 234, 177, 2, 29, "Input",ExpressionUUID->"dfbe1a3d-bace-4afc-905c-3b6d2ac160b5"],
Cell[8096, 238, 333, 8, 53, "Output",ExpressionUUID->"8f6fdf80-99a3-4b02-9724-278b07360df0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8466, 251, 315, 5, 29, "Input",ExpressionUUID->"b1fba865-8e36-4e58-a48b-28b11b3e9e23"],
Cell[8784, 258, 1543, 47, 62, "Output",ExpressionUUID->"17545e73-30ec-4696-aeb0-a5161afec6e9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10364, 310, 339, 8, 29, "Input",ExpressionUUID->"8ad8f2de-ca8b-40e9-9f86-d15acc512edb"],
Cell[10706, 320, 234, 3, 33, "Output",ExpressionUUID->"723d85b3-b24c-4fa3-96f3-78471d027fd1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10977, 328, 271, 5, 29, "Input",ExpressionUUID->"a95ea81d-176c-4f91-8ebb-e735b9e3085c"],
Cell[11251, 335, 418, 11, 99, "Output",ExpressionUUID->"431cad6e-4bd7-4fbf-baa4-ed6bd9f9f380"]
}, Open  ]],
Cell[11684, 349, 152, 3, 29, "Input",ExpressionUUID->"6d2e5427-f91e-4a89-8e94-5e467dec3379"],
Cell[11839, 354, 156, 3, 29, "Input",ExpressionUUID->"501a1311-2a27-43f7-8399-bf2a4ed058fc"],
Cell[11998, 359, 177, 3, 29, "Input",ExpressionUUID->"9bc78e3c-edd0-40a6-aedf-abd2052bcd2f"]
}, Open  ]]
}
]
*)

